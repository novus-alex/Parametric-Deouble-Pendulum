import numpy as np
import matplotlib.pyplot as plt
import scienceplots

plt.style.use('science')

t = [ 0, 0.033366, 0.066732, 0.100098, 0.133464, 0.16683, 0.200196, 0.233562, 0.266928, 0.300294, 0.33366, 0.367026, 0.400392, 0.433758, 0.467124, 0.50049, 0.533856, 0.567222, 0.600588, 0.633954, 0.66732, 0.700686, 0.734052, 0.767418, 0.800784, 0.83415, 0.867516, 0.900882, 0.934248, 0.967614, 1.00098]
x = [-0.0121725, -0.0133898, -0.0133898, -0.0133898, -0.0133898, -0.014607, -0.0121725, -0.0133898, -0.0133898, -0.0133898, -0.0133898, -0.0133898, -0.0133898, -0.0133898, -0.0133898, -0.0133898, -0.0133898, -0.0133898, -0.0133898, -0.0413865, -0.0973801, -0.149722, -0.152156, -0.150939, -0.157025, -0.150939, -0.153374, -0.155808, -0.149722, -0.152156, -0.153374]
y = [-0.198412, -0.198412, -0.198412, -0.198412, -0.198412, -0.198412, -0.198412, -0.198412, -0.198412, -0.198412, -0.198412, -0.198412, -0.198412, -0.198412, -0.198412, -0.198412, -0.198412, -0.198412, -0.198412, -0.195977, -0.175284, -0.133898, -0.127811, -0.130246, -0.121725, -0.129029, -0.126594, -0.12416, -0.131463, -0.130246, -0.127811]

t = np.array(t)
x = -np.array(x)
y = np.array(y)

theta = np.arctan2(y,x)
theta = theta - theta[0]
t_ = np.linspace(0, max(t), 300)

k, w = 30, 10
u = 1 / (1 + np.exp(-k * np.sin(w * (t_)))) * 0.8
fig = plt.figure(figsize=(6,4))
#plt.errorbar(t, 0.8/(theta+0.01) - 1, xerr = [0]*len(t), yerr = [0.05]*len(t), capsize = 5, marker = 'o', markersize = 5, color = 'k', linestyle = 'none')
plt.plot(t_, u, "r")
plt.xlabel("Temps (s)")
plt.ylabel(r"$u(t)$ (rad)")
#plt.savefig("exc_ex.png", dpi=300)
plt.show()